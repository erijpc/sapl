{% extends "crud/list.html" %}
{% load i18n %}
{% load common_tags %}

{% block base_content %}
    {% if lista_materias_expediente_disponiveis %}
        {% if sessoes_disponiveis %}
            {% if numero_resultados == 1 %}
                <h3 style="text-align: right;">{% trans 'Existe 1 matéria do expediente disponível para cópia.' %}</h3>
            {% else %}
                <h3 style="text-align: right;">Existem {{ numero_resultados }} matérias do expediente disponíveis para cópia.</h3>
            {% endif %}
            <form method="POST" enctype="multipart/form-data">
                {% csrf_token %}
                <fieldset>
                    <legend><b>Sessão Plenária Destino</b></legend>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Sessão Plenária*</label>
                                <select id="id_sessao_plenaria" class="select form-control" name="sessao_plenaria" required="True">
                                    {% for sessao in sessoes_disponiveis %}
                                        <option value="{{ sessao.pk }}">{{ sessao }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                    </div>
                    <br/>
                    <legend><b>Matérias Não Votadas ou Não Lidas</b></legend>
                    <table class="table table-striped table-hover">
                        <div class="controls">
                            <div class="checkbox">
                                <label for="id_check_all">
                                    <input type="checkbox" id="id_check_all" onchange="checkAll(this)"/>Marcar/Desmarcar Todos
                                </label>
                            </div>
                        </div>
                        <thead><tr><th>Matéria do Expediente</th></tr></thead>
                        <tbody>
                            {% for expediente in lista_materias_expediente_disponiveis %}
                                <tr>
                                    <td>
                                        <input type="checkbox" name="expediente_id" value="{{ expediente.id }}" {% if check %} checked {% endif %}/>
                                        {{ expediente.materia.tipo.sigla }} {{ expediente.materia.numero }}/{{ expediente.materia.ano }} - {{ expediente.materia.tipo.descricao }}
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </fieldset>
                <input type="submit" value="Salvar" class="btn btn-primary"S>
            </form>
        {% else %}
            <br/>
            <tr><td><h3 style="text-align: center;">Nenhuma sessão plenária está apta a receber a(s) cópia(s) de matéria do expediente.</h3></td></tr>
        {% endif %}
    {% else %}
        <br/> 
        <tr><td><h3 style="text-align: center;">Nenhuma matéria do expediente dessa sessão plenária está disponível para cópia.</h3></td></tr>
    {% endif %}
{% endblock base_content %}

{% block extra_js %}
    <script language="Javascript">
        function checkAll(elem){
            let checkboxes = document.getElementsByName('expediente_id');
            for(let i=0; i<checkboxes.length; i++){
                checkboxes[i].checked = elem.checked;
            }
        }
    </script>
{% endblock %}
